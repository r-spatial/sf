<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sf">
<title>2. Reading, Writing and Converting Simple Features • sf</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Reading, Writing and Converting Simple Features">
<meta property="og:description" content="sf">
<meta property="og:image" content="https://r-spatial.github.io/sf/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0-17</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/sf1.html">1. Simple Features for R</a>
    <a class="dropdown-item" href="../articles/sf2.html">2. Reading, Writing and Converting Simple Features</a>
    <a class="dropdown-item" href="../articles/sf3.html">3. Manipulating Simple Feature Geometries</a>
    <a class="dropdown-item" href="../articles/sf4.html">4. Manipulating Simple Features</a>
    <a class="dropdown-item" href="../articles/sf5.html">5. Plotting Simple Features</a>
    <a class="dropdown-item" href="../articles/sf6.html">6. Miscellaneous</a>
    <a class="dropdown-item" href="../articles/sf7.html">7. Spherical geometry in sf using s2geometry</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-spatial/sf/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>2. Reading, Writing and Converting Simple Features</h1>
                        <h4 data-toc-skip class="author">Edzer
Pebesma</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/sf/blob/HEAD/vignettes/sf2.Rmd" class="external-link"><code>vignettes/sf2.Rmd</code></a></small>
      <div class="d-none name"><code>sf2.Rmd</code></div>
    </div>

    
    
<p>This vignette describes how simple features can be read in R from
files or databases, and how they can be converted to other formats
(text, <a href="https://cran.r-project.org/package=sp" class="external-link">sp</a>)</p>
<div class="section level2">
<h2 id="reading-and-writing-through-gdal">Reading and writing through GDAL<a class="anchor" aria-label="anchor" href="#reading-and-writing-through-gdal"></a>
</h2>
<p>The Geospatial Data Abstraction Library (<a href="https://gdal.org/" class="external-link">GDAL</a>) is the Swiss Army Knife for spatial
data: it reads and writes vector and raster data from and to practically
every file format, or database, of significance. Package <code>sf</code>
reads and writes using GDAL using <code><a href="../reference/st_read.html">st_read()</a></code> and
<code><a href="../reference/st_write.html">st_write()</a></code>.</p>
<p>The data model GDAL uses needs</p>
<ul>
<li>a data source, which may be a file, directory, or database</li>
<li>a layer, which is a single geospatial dataset inside a file or
directory or e.g. a table in a database.</li>
<li>the specification of a driver (i.e., which format)</li>
<li>driver-specific reading or writing data sources, or layers</li>
</ul>
<p>This may sound complex, but it is needed to map to over 200 data
formats! Package <code>sf</code> tries hard to simplify this where
possible (e.g. a file contains a single layer), but this vignette will
try to point you to the options.</p>
<div class="section level3">
<h3 id="using-st_read">Using st_read<a class="anchor" aria-label="anchor" href="#using-st_read"></a>
</h3>
<p>As an example, we read the North Carolina counties SIDS dataset,
which comes shipped with the <code>sf</code> package by:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="co">## Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shape/nc.shp"</span>, package<span class="op">=</span><span class="st">"sf"</span><span class="op">)</span></span>
<span><span class="va">fname</span></span>
<span><span class="co">## [1] "/home/runner/work/_temp/Library/sf/shape/nc.shp"</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/st_read.html">st_read</a></span><span class="op">(</span><span class="va">fname</span><span class="op">)</span></span>
<span><span class="co">## Reading layer `nc' from data source </span></span>
<span><span class="co">##   `/home/runner/work/_temp/Library/sf/shape/nc.shp' using driver `ESRI Shapefile'</span></span>
<span><span class="co">## Simple feature collection with 100 features and 14 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</span></span>
<span><span class="co">## Geodetic CRS:  NAD27</span></span></code></pre></div>
<p>Typical users will use a file name with path for <code>fname</code>,
or first set R’s working directory with <code><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd()</a></code> and use
file name without path.</p>
<p>We see here that a single argument is used to find both the
datasource and the layer. This works when the datasource contains a
single layer. In case the number of layers is zero (e.g. a database with
no tables), an error message is given. In case there are more layers
than one, the first layer is returned, but a message and a warning are
given:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">st_read</span>(<span class="st">"PG:dbname=postgis"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>Multiple layers are present <span class="cf">in</span> data source PG<span class="sc">:</span>dbname<span class="ot">=</span>postgis, reading layer <span class="st">`</span><span class="at">meuse'.</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="at">Use </span><span class="st">`</span>st_layers<span class="st">' to list all layer names and their type in a data source.</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="st">Set the `layer'</span> argument <span class="cf">in</span> <span class="st">`</span><span class="at">st_read' to read a particular layer.</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="at">Reading layer </span><span class="st">`</span>meuse<span class="st">' from data source `PG:dbname=postgis'</span> using driver <span class="st">`</span><span class="at">PostgreSQL'</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="at">Simple feature collection with 155 features and 12 fields</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="at">geometry type:  POINT</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="at">dimension:      XY</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="at">bbox:           xmin: 178605 ymin: 329714 xmax: 181390 ymax: 333611</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="at">epsg (SRID):    28992</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="at">proj4string:    +proj=sterea +lat_0=52.15616055555555 ...</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="at">Warning message:</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="at">In eval(substitute(expr), envir, enclos) :</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="at">  automatically selected the first layer in a data source containing more than one.</span></span></code></pre></div>
<p>The message points to the <code><a href="../reference/st_layers.html">st_layers()</a></code> command, which
lists the driver and layers in a datasource, e.g.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">st_layers</span>(<span class="st">"PG:dbname=postgis"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>Driver<span class="sc">:</span> PostgreSQL </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>Available layers<span class="sc">:</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  layer_name geometry_type features fields</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="dv">1</span>      meuse         Point      <span class="dv">155</span>     <span class="dv">12</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="dv">2</span>   meuse_sf         Point      <span class="dv">155</span>     <span class="dv">12</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="dv">3</span>       sids Multi Polygon      <span class="dv">100</span>     <span class="dv">14</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="dv">4</span>  meuse_tbl         Point      <span class="dv">155</span>     <span class="dv">13</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="dv">5</span> meuse_tbl2         Point      <span class="dv">155</span>     <span class="dv">13</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="sc">&gt;</span> </span></code></pre></div>
<p>A particular layer can now be read by e.g.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"PG:dbname=postgis"</span>, <span class="st">"sids"</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/st_layers.html">st_layers()</a></code> has the option to count the number of
features in case these are missing: some datasources (e.g. OSM xml
files) do not report the number of features, but need to be completely
read for this. GDAL allows for more than one geometry column for a
feature layer; these are reported by <code><a href="../reference/st_layers.html">st_layers()</a></code>.</p>
<p>In case a layer contains only geometries but no attributes (fields),
<code><a href="../reference/st_read.html">st_read()</a></code> still returns an <code>sf</code> object, with a
geometry column only.</p>
<p>We see that GDAL automatically detects the driver (file format) of
the datasource, by trying them all in turn.</p>
<p><code><a href="../reference/st_read.html">st_read()</a></code> follows the conventions of base R, similar to
how it reads tabular data into <code>data.frame</code>s. This means that
character data are read, by default as <code>factor</code>s. For those
who insist on retrieving character data as character vectors, the
argument <code>stringsAsFactors</code> can be set to
<code>FALSE</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/st_read.html">st_read</a></span><span class="op">(</span><span class="va">fname</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, a user can set the global option
<code>stringsAsFactors</code>, and this will have the same effect:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/st_read.html">st_read</a></span><span class="op">(</span><span class="va">fname</span><span class="op">)</span></span>
<span><span class="co">## Reading layer `nc' from data source </span></span>
<span><span class="co">##   `/home/runner/work/_temp/Library/sf/shape/nc.shp' using driver `ESRI Shapefile'</span></span>
<span><span class="co">## Simple feature collection with 100 features and 14 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</span></span>
<span><span class="co">## Geodetic CRS:  NAD27</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-st_write">Using st_write<a class="anchor" aria-label="anchor" href="#using-st_write"></a>
</h3>
<p>To write a simple features object to a file, we need at least two
arguments, the object and a filename:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/st_write.html">st_write</a></span><span class="op">(</span><span class="va">nc</span>, <span class="st">"nc1.shp"</span><span class="op">)</span></span></code></pre></div>
<p>The file name is taken as the data source name. The default for the
layer name is the basename (filename without path) of the the data
source name. For this, <code><a href="../reference/st_write.html">st_write()</a></code> needs to guess the
driver. The above command is, for instance, equivalent to:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/st_write.html">st_write</a></span><span class="op">(</span><span class="va">nc</span>, dsn <span class="op">=</span> <span class="st">"nc1.shp"</span>, layer <span class="op">=</span> <span class="st">"nc.shp"</span>, driver <span class="op">=</span> <span class="st">"ESRI Shapefile"</span><span class="op">)</span></span>
<span><span class="co">## Writing layer `nc' to data source `nc1.shp' using driver `ESRI Shapefile'</span></span>
<span><span class="co">## Writing 100 features with 14 fields and geometry type Multi Polygon.</span></span></code></pre></div>
<p>How the guessing of drivers works is explained in the next
section.</p>
</div>
<div class="section level3">
<h3 id="guessing-a-driver-for-output">Guessing a driver for output<a class="anchor" aria-label="anchor" href="#guessing-a-driver-for-output"></a>
</h3>
<p>The output driver is guessed from the datasource name, either from
its extension (<code>.shp</code>: <code>ESRI Shapefile</code>), or its
prefix (<code>PG:</code>: <code>PostgreSQL</code>). The list of
extensions with corresponding driver (short driver name) is:</p>
<table class="table">
<thead><tr class="header">
<th>extension</th>
<th>driver short name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>bna</code></td>
<td><code>BNA</code></td>
</tr>
<tr class="even">
<td><code>csv</code></td>
<td><code>CSV</code></td>
</tr>
<tr class="odd">
<td><code>e00</code></td>
<td><code>AVCE00</code></td>
</tr>
<tr class="even">
<td><code>gdb</code></td>
<td><code>FileGDB</code></td>
</tr>
<tr class="odd">
<td><code>geojson</code></td>
<td><code>GeoJSON</code></td>
</tr>
<tr class="even">
<td><code>gml</code></td>
<td><code>GML</code></td>
</tr>
<tr class="odd">
<td><code>gmt</code></td>
<td><code>GMT</code></td>
</tr>
<tr class="even">
<td><code>gpkg</code></td>
<td><code>GPKG</code></td>
</tr>
<tr class="odd">
<td><code>gps</code></td>
<td><code>GPSBabel</code></td>
</tr>
<tr class="even">
<td><code>gtm</code></td>
<td><code>GPSTrackMaker</code></td>
</tr>
<tr class="odd">
<td><code>gxt</code></td>
<td><code>Geoconcept</code></td>
</tr>
<tr class="even">
<td><code>jml</code></td>
<td><code>JML</code></td>
</tr>
<tr class="odd">
<td><code>map</code></td>
<td><code>WAsP</code></td>
</tr>
<tr class="even">
<td><code>mdb</code></td>
<td><code>Geomedia</code></td>
</tr>
<tr class="odd">
<td><code>nc</code></td>
<td><code>netCDF</code></td>
</tr>
<tr class="even">
<td><code>ods</code></td>
<td><code>ODS</code></td>
</tr>
<tr class="odd">
<td><code>osm</code></td>
<td><code>OSM</code></td>
</tr>
<tr class="even">
<td><code>pbf</code></td>
<td><code>OSM</code></td>
</tr>
<tr class="odd">
<td><code>shp</code></td>
<td><code>ESRI Shapefile</code></td>
</tr>
<tr class="even">
<td><code>sqlite</code></td>
<td><code>SQLite</code></td>
</tr>
<tr class="odd">
<td><code>vdv</code></td>
<td><code>VDV</code></td>
</tr>
<tr class="even">
<td><code>xls</code></td>
<td><code>xls</code></td>
</tr>
<tr class="odd">
<td><code>xlsx</code></td>
<td><code>XLSX</code></td>
</tr>
</tbody>
</table>
<p>The list with prefixes is:</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="86%">
</colgroup>
<thead><tr class="header">
<th>prefix</th>
<th>driver short name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>couchdb:</code></td>
<td><code>CouchDB</code></td>
</tr>
<tr class="even">
<td><code>DB2ODBC:</code></td>
<td><code>DB2ODBC</code></td>
</tr>
<tr class="odd">
<td><code>DODS:</code></td>
<td><code>DODS</code></td>
</tr>
<tr class="even">
<td><code>GFT:</code></td>
<td><code>GFT</code></td>
</tr>
<tr class="odd">
<td><code>MSSQL:</code></td>
<td><code>MSSQLSpatial</code></td>
</tr>
<tr class="even">
<td><code>MySQL:</code></td>
<td><code>MySQL</code></td>
</tr>
<tr class="odd">
<td><code>OCI:</code></td>
<td><code>OCI</code></td>
</tr>
<tr class="even">
<td><code>ODBC:</code></td>
<td><code>ODBC</code></td>
</tr>
<tr class="odd">
<td><code>PG:</code></td>
<td><code>PostgreSQL</code></td>
</tr>
<tr class="even">
<td><code>SDE:</code></td>
<td><code>SDE</code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="dataset-and-layer-reading-or-creation-options">Dataset and layer reading or creation options<a class="anchor" aria-label="anchor" href="#dataset-and-layer-reading-or-creation-options"></a>
</h3>
<p>Various GDAL drivers have options that influences the reading or
writing process, for example what the driver should do when a table
already exists in a database: append records to the table or overwrite
it:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/st_write.html">st_write</a></span><span class="op">(</span><span class="fu"><a href="../reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span>, <span class="st">"PG:dbname=postgis"</span>, <span class="st">"meuse"</span>, </span>
<span>    layer_options <span class="op">=</span> <span class="st">"OVERWRITE=true"</span><span class="op">)</span></span></code></pre></div>
<p>In case the table exists and the option is not specified, the driver
will give an error. Driver-specific options are documented in the driver
manual of <a href="https://gdal.org/drivers/vector/index.html" class="external-link">gdal</a>.
Multiple options can be given by multiple strings in
<code>options</code>.</p>
<p>For <code><a href="../reference/st_read.html">st_read()</a></code>, there is only <code>options</code>; for
<code><a href="../reference/st_write.html">st_write()</a></code>, one needs to distinguish between
<code>dataset_options</code> and <code>layer_options</code>, the first
related to opening a dataset, the second to creating layers in the
dataset.</p>
</div>
</div>
<div class="section level2">
<h2 id="reading-and-writing-directly-to-and-from-spatial-databases">Reading and writing directly to and from spatial databases<a class="anchor" aria-label="anchor" href="#reading-and-writing-directly-to-and-from-spatial-databases"></a>
</h2>
<p>Package <code>sf</code> supports reading and writing from and to
spatial databases using the <code>DBI</code> interface. So far, testing
has mainly be done with <code>PostGIS</code>, other databases might work
but may also need more work. An example of reading is:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tomoakin/RPostgreSQL" class="external-link">RPostgreSQL</a></span><span class="op">)</span> </span>
<span><span class="va">conn</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RPostgreSQL/man/PostgreSQL.html" class="external-link">PostgreSQL</a></span><span class="op">(</span><span class="op">)</span>, dbname <span class="op">=</span> <span class="st">"postgis"</span><span class="op">)</span> </span>
<span><span class="va">meuse</span> <span class="op">=</span> <span class="fu"><a href="../reference/st_read.html">st_read</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"meuse"</span><span class="op">)</span></span>
<span><span class="va">meuse_1_3</span> <span class="op">=</span> <span class="fu"><a href="../reference/st_read.html">st_read</a></span><span class="op">(</span><span class="va">conn</span>, query <span class="op">=</span> <span class="st">"select * from meuse limit 3;"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">conn</span><span class="op">)</span> </span></code></pre></div>
<p>We see here that in the second example a query is given. This query
may contain spatial predicates, which could be a way to work through
massive spatial datasets in R without having to read them completely in
memory.</p>
<p>Similarly, tables can be written:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conn</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RPostgreSQL/man/PostgreSQL.html" class="external-link">PostgreSQL</a></span><span class="op">(</span><span class="op">)</span>, dbname <span class="op">=</span> <span class="st">"postgis"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/st_write.html">st_write</a></span><span class="op">(</span><span class="va">conn</span>, <span class="va">meuse</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">conn</span><span class="op">)</span></span></code></pre></div>
<p>Here, the default table (layer) name is taken from the object name
(<code>meuse</code>). Argument <code>drop</code> informs to drop
(remove) the table before writing; logical argument <code>binary</code>
determines whether to use well-known binary or well-known text when
writing the geometry (where well-known binary is faster and
lossless).</p>
</div>
<div class="section level2">
<h2 id="conversion-to-other-formats-wkt-wkb-sp">Conversion to other formats: WKT, WKB, sp<a class="anchor" aria-label="anchor" href="#conversion-to-other-formats-wkt-wkb-sp"></a>
</h2>
<div class="section level3">
<h3 id="conversion-to-and-from-well-known-text">Conversion to and from well-known text<a class="anchor" aria-label="anchor" href="#conversion-to-and-from-well-known-text"></a>
</h3>
<p>The usual form in which we see simple features printed is well-known
text:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## POINT (0 1)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/st.html">st_linestring</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">9</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</span></span></code></pre></div>
<p>We can create these well-known text strings explicitly using
<code>st_as_text</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/st.html">st_linestring</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">9</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">str</span> <span class="op">=</span> <span class="fu"><a href="../reference/st_as_text.html">st_as_text</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</span></span></code></pre></div>
<p>We can convert back from WKT by using <code><a href="../reference/st_as_sfc.html">st_as_sfc()</a></code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span></span>
<span><span class="co">## Geometry set for 1 feature </span></span>
<span><span class="co">## Geometry type: LINESTRING</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 0 ymin: 1 xmax: 8 ymax: 9</span></span>
<span><span class="co">## CRS:           NA</span></span>
<span><span class="co">## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="conversion-to-and-from-well-known-binary">Conversion to and from well-known binary<a class="anchor" aria-label="anchor" href="#conversion-to-and-from-well-known-binary"></a>
</h3>
<p>Well-known binary is created from simple features by
<code><a href="../reference/st_as_binary.html">st_as_binary()</a></code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/st.html">st_linestring</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">9</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/st_as_binary.html">st_as_binary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##  [1] 01 02 00 00 00 05 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f0 3f</span></span>
<span><span class="co">## [26] 00 00 00 00 00 00 00 40 00 00 00 00 00 00 08 40 00 00 00 00 00 00 10 40 00</span></span>
<span><span class="co">## [51] 00 00 00 00 00 14 40 00 00 00 00 00 00 18 40 00 00 00 00 00 00 1c 40 00 00</span></span>
<span><span class="co">## [76] 00 00 00 00 20 40 00 00 00 00 00 00 22 40</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">## [1] "raw"</span></span></code></pre></div>
<p>The object returned by <code><a href="../reference/st_as_binary.html">st_as_binary()</a></code> is of class
<code>WKB</code> and is either a list with raw vectors, or a single raw
vector. These can be converted into a hexadecimal character vector using
<code><a href="../reference/rawToHex.html">rawToHex()</a></code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rawToHex.html">rawToHex</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">## [1] "0102000000050000000000000000000000000000000000f03f000000000000004000000000000008400000000000001040000000000000144000000000000018400000000000001c4000000000000020400000000000002240"</span></span></code></pre></div>
<p>Converting back to <code>sf</code> uses <code><a href="../reference/st_as_sfc.html">st_as_sfc()</a></code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/st_as_binary.html">st_as_binary</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="../reference/st.html">st_point</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="../reference/st.html">st_point</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">## Geometry set for 2 features </span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 0 ymin: 1 xmax: 5 ymax: 6</span></span>
<span><span class="co">## CRS:           NA</span></span>
<span><span class="co">## POINT (0 1)</span></span>
<span><span class="co">## POINT (5 6)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="conversion-to-and-from-sp">Conversion to and from sp<a class="anchor" aria-label="anchor" href="#conversion-to-and-from-sp"></a>
</h3>
<p>Spatial objects as maintained by package <code>sp</code> can be
converted into simple feature objects or geometries by
<code><a href="../reference/st_as_sf.html">st_as_sf()</a></code> and <code><a href="../reference/st_as_sfc.html">st_as_sfc()</a></code>, respectively:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span><span class="va">st_as_sf</span><span class="op">)</span></span>
<span><span class="co">##  [1] st_as_sf.data.frame*   st_as_sf.lpp*          st_as_sf.map*         </span></span>
<span><span class="co">##  [4] st_as_sf.owin*         st_as_sf.ppp*          st_as_sf.ppplist*     </span></span>
<span><span class="co">##  [7] st_as_sf.psp*          st_as_sf.s2_geography* st_as_sf.sf*          </span></span>
<span><span class="co">## [10] st_as_sf.sfc*          st_as_sf.Spatial*      st_as_sf.SpatVector*  </span></span>
<span><span class="co">## see '?methods' for accessing help and source code</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span><span class="va">st_as_sfc</span><span class="op">)</span></span>
<span><span class="co">##  [1] st_as_sfc.bbox*               st_as_sfc.blob*              </span></span>
<span><span class="co">##  [3] st_as_sfc.character*          st_as_sfc.dimensions*        </span></span>
<span><span class="co">##  [5] st_as_sfc.factor*             st_as_sfc.list*              </span></span>
<span><span class="co">##  [7] st_as_sfc.map*                st_as_sfc.owin*              </span></span>
<span><span class="co">##  [9] st_as_sfc.pq_geometry*        st_as_sfc.psp*               </span></span>
<span><span class="co">## [11] st_as_sfc.raw*                st_as_sfc.s2_geography*      </span></span>
<span><span class="co">## [13] st_as_sfc.sf*                 st_as_sfc.SpatialLines*      </span></span>
<span><span class="co">## [15] st_as_sfc.SpatialMultiPoints* st_as_sfc.SpatialPixels*     </span></span>
<span><span class="co">## [17] st_as_sfc.SpatialPoints*      st_as_sfc.SpatialPolygons*   </span></span>
<span><span class="co">## [19] st_as_sfc.tess*               st_as_sfc.WKB*               </span></span>
<span><span class="co">## see '?methods' for accessing help and source code</span></span></code></pre></div>
<p>An example would be:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span> <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span><span class="va">m.sf</span> <span class="op">=</span> <span class="fu"><a href="../reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span></span>
<span><span class="va">opar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">m.sf</span><span class="op">)</span></span>
<span><span class="co">## Warning: plotting the first 10 out of 12 attributes; use max.plot = 12 to plot</span></span>
<span><span class="co">## all</span></span></code></pre></div>
<p><img src="sf2_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>Conversion of simple feature objects of class <code>sf</code> or
<code>sfc</code> into corresponding <code>Spatial*</code> objects is
done using the <code>as</code> method, coercing to
<code>Spatial</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="../reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/coerce-methods.html">as</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"Spatial"</span><span class="op">)</span></span>
<span><span class="co">## SpatialPoints:</span></span>
<span><span class="co">##      coords.x1 coords.x2</span></span>
<span><span class="co">## [1,]         5         5</span></span>
<span><span class="co">## [2,]         6         9</span></span>
<span><span class="co">## Coordinate Reference System (CRS) arguments: +proj=longlat +datum=WGS84</span></span>
<span><span class="co">## +no_defs</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edzer Pebesma.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
