<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>5. Plotting Simple Features • sf</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="5. Plotting Simple Features">
<meta property="og:description" content="sf">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0-6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sf1.html">1. Simple Features for R</a>
    </li>
    <li>
      <a href="../articles/sf2.html">2. Reading, Writing and Converting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf3.html">3. Manipulating Simple Feature Geometries</a>
    </li>
    <li>
      <a href="../articles/sf4.html">4. Manipulating Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf5.html">5. Plotting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf6.html">6. Miscellaneous</a>
    </li>
    <li>
      <a href="../articles/sf7.html">7. Spherical geometry in sf using s2geometry</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-spatial/sf/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sf5_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>5. Plotting Simple Features</h1>
                        <h4 data-toc-skip class="author">Edzer Pebesma</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/sf/blob/HEAD/vignettes/sf5.Rmd" class="external-link"><code>vignettes/sf5.Rmd</code></a></small>
      <div class="hidden name"><code>sf5.Rmd</code></div>

    </div>

    
    
<p>This vignette describes the functions in <code>sf</code> that can help to plot simple features. It tries to be complete about the plot methods <code>sf</code> provides, and give examples and pointers to options to plot simple feature objects with other packages (mapview, tmap, ggplot2).</p>
<div class="section level1">
<h1 id="plot-methods-for-sf-and-sfc-objects">Plot methods for <code>sf</code> and <code>sfc</code> objects<a class="anchor" aria-label="anchor" href="#plot-methods-for-sf-and-sfc-objects"></a>
</h1>
<div class="section level2">
<h2 id="geometry-only-sfc">Geometry only: <code>sfc</code><a class="anchor" aria-label="anchor" href="#geometry-only-sfc"></a>
</h2>
<p>Geometry list-columns (objects of class <code>sfc</code>, obtained by the <code>st_geometry</code> method) only show the geometry:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Linking to GEOS 3.10.1, GDAL 3.3.3, PROJ 8.2.0; sf_use_s2() is TRUE</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/demo.html" class="external-link">demo</a></span><span class="op">(</span><span class="va">nc</span>, ask <span class="op">=</span> <span class="cn">FALSE</span>, echo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Reading layer `nc.gpkg' from data source </span>
<span class="co">##   `/private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/Rtmp0IT0v9/temp_libpath47fd1cf31904/sf/gpkg/nc.gpkg' </span>
<span class="co">##   using driver `GPKG'</span>
<span class="co">## Simple feature collection with 100 features and 14 fields</span>
<span class="co">## Attribute-geometry relationship: 0 constant, 8 aggregate, 6 identity</span>
<span class="co">## Geometry type: MULTIPOLYGON</span>
<span class="co">## Dimension:     XY</span>
<span class="co">## Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</span>
<span class="co">## Geodetic CRS:  NAD27</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>which can be further annotated with colors, symbols, etc., as the usual base plots, e.g. points are added to a polygon plot by:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/plot.html">sf.colors</a></span><span class="op">(</span><span class="fl">12</span>, categorical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, border <span class="op">=</span> <span class="st">'grey'</span>, 
     axes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="fu"><a href="../reference/geos_unary.html">st_centroid</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">'red'</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in st_centroid.sf(nc): st_centroid assumes attributes are constant over</span>
<span class="co">## geometries of x</span></code></pre>
<p><img src="sf5_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>and legends, titles and so on can be added afterwards. <code>border=NA</code> removes the polygon borders.</p>
<p>As can be seen, the axes plotted are sensitive to the CRS, and in case of longitude/latitude coordinates, degree symbols and orientation are added if <code>axes = TRUE</code>.</p>
</div>
<div class="section level2">
<h2 id="geometry-with-attributes-sf">Geometry with attributes: <code>sf</code><a class="anchor" aria-label="anchor" href="#geometry-with-attributes-sf"></a>
</h2>
<p>The default plot of an <code>sf</code> object is a multi-plot of all attributes, up to a reasonable maximum:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: plotting the first 9 out of 14 attributes; use max.plot = 14 to plot</span>
<span class="co">## all</span></code></pre>
<p><img src="sf5_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>with a warning when not all attributes can be reasonably plotted. One can increase the maximum number of maps to be plotted by</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">nc</span>, max.plot <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>The row/column layout is chosen such that the plotting area is maximally filled. The default value for <code>max.plot</code> can be controlled, e.g. by setting the global option <code>sf_max.plot</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>sf_max.plot<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
</div>
<div class="section level1">
<h1 id="color-key-place-and-size">Color key place and size<a class="anchor" aria-label="anchor" href="#color-key-place-and-size"></a>
</h1>
<p>In case a single attribute is selected, by default a color key is given the side of the plot where it leaves as much as possible room for the plotted map; for <code>nc</code> this is below:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">nc</span><span class="op">[</span><span class="st">"AREA"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>but this can be controlled, and set to a particular side (1=below, 2=left, 3=above and 4=right):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">nc</span><span class="op">[</span><span class="st">"AREA"</span><span class="op">]</span>, key.pos <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>The size of a color key can be controlled, using either relative units (a number between 0 and 1) or absolute units (like <code>lcm(2)</code> for 2 cm):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">nc</span><span class="op">[</span><span class="st">"AREA"</span><span class="op">]</span>, key.pos <span class="op">=</span> <span class="fl">1</span>, axes <span class="op">=</span> <span class="cn">TRUE</span>, key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">lcm</a></span><span class="op">(</span><span class="fl">1.3</span><span class="op">)</span>, key.length <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Keys for factor variables are a bit different, as we typically don’t want to rotate text for them:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nc</span><span class="op">$</span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">nc</span><span class="op">$</span><span class="va">AREA</span>, <span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">nc</span><span class="op">[</span><span class="st">"f"</span><span class="op">]</span>, axes <span class="op">=</span> <span class="cn">TRUE</span>, key.pos <span class="op">=</span> <span class="fl">4</span>, pal <span class="op">=</span> <span class="fu"><a href="../reference/plot.html">sf.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">lcm</a></span><span class="op">(</span><span class="fl">4.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level1">
<h1 id="class-intervals">Class intervals<a class="anchor" aria-label="anchor" href="#class-intervals"></a>
</h1>
<p>Color breaks (class intervals) can be controlled by plot arguments <code>breaks</code> and <code>nbreaks</code>. <code>nbreaks</code> specifies the number of breaks; <code>breaks</code> is either a vector with break values:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">nc</span><span class="op">[</span><span class="st">"AREA"</span><span class="op">]</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.05</span>,<span class="fl">.1</span>,<span class="fl">.15</span>,<span class="fl">.2</span>,<span class="fl">.25</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>or <code>breaks</code> is used to indicate a breaks-finding method that is passed as the <code>style</code> argument to <code><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html" class="external-link">classInt::classIntervals</a></code>. Its default value, <code>pretty</code>, results in rounded class breaks, and has as a side effect that <code>nbreaks</code> may be honoured only approximately. Other methods include <code>"equal"</code> to break the data range into <code>"nbreaks"</code> equal classes, <code>"quantile"</code> to use quantiles as class breaks, and <code>"jenks"</code>, used in other software.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">nc</span><span class="op">[</span><span class="st">"AREA"</span><span class="op">]</span>, breaks <span class="op">=</span> <span class="st">"jenks"</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level1">
<h1 id="how-does-sf-project-geographic-coordinates">How does <code>sf</code> project geographic coordinates?<a class="anchor" aria-label="anchor" href="#how-does-sf-project-geographic-coordinates"></a>
</h1>
<p>Package <code>sf</code> plots projected maps in their native projection, meaning that easting and northing are mapped linearly to the x and y axis, keeping an aspect ratio of 1 (one unit east equals one unit north). For geographic data, where coordinates constitute degrees longitude and latitude, it chooses an <a href="https://en.wikipedia.org/wiki/Equirectangular_projection" class="external-link">equirectangular projection</a> (also called <em>equidistant circular</em>), where at the center of the plot (or of the bounding box) one unit north equals one unit east.</p>
<p>Proj.4 also lets you project data to this projection, and the plot of</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>should, apart from the values along axes, be otherwise identical to</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lat_ts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># latitude of true scale</span>
<span class="va">eqc</span> <span class="op">=</span> <span class="fu"><a href="../reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">nc</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"+proj=eqc +lat_ts="</span>, <span class="va">lat_ts</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">eqc</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level1">
<h1 id="graticules">Graticules<a class="anchor" aria-label="anchor" href="#graticules"></a>
</h1>
<p>Graticules are grid lines along equal longitude (meridians) or latitude (parallels) that, depending on the projection used, often plot as curved lines on a map, giving it reference in terms of longitude and latitude. The <code>sf</code> function <code>st_graticule</code> tries to create a graticule grid for arbitrary maps. As there are infinitely many projections, there are most likely many cases where it does not succeed in doing this well, and examples of these are welcomed as <a href="https://github.com/r-spatial/sf/issues" class="external-link">sf issues</a>.</p>
<p>The following plot shows a graticule geometry on itself,</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">maps</span><span class="op">)</span>
<span class="va">usa</span> <span class="op">=</span> <span class="fu"><a href="../reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html" class="external-link">map</a></span><span class="op">(</span><span class="st">'usa'</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">laea</span> <span class="op">=</span> <span class="fu"><a href="../reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="st">"+proj=laea +lat_0=30 +lon_0=-95"</span><span class="op">)</span> <span class="co"># Lambert equal area</span>
<span class="va">usa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">usa</span>, <span class="va">laea</span><span class="op">)</span>
<span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="../reference/st_graticule.html">st_graticule</a></span><span class="op">(</span><span class="va">usa</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>where we see that the graticule does not reach the plot boundaries (but is cut off at the bounding box of <code>usa</code>), and that the axes show projected coordinates.</p>
<p>When we compute the graticule within the plotting function, we know the plotting region and can compute it up to the plot margins, and add axes in graticule units:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">usa</span>, graticule <span class="op">=</span> <span class="cn">TRUE</span>, key.pos <span class="op">=</span> <span class="cn">NULL</span>, axes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>We can also pass a <code>crs</code> object to <code>graticule</code> to obtain a graticule in a datum different from the default (WGS84). <code>st_graticule</code> takes parameters, and we can pass an object returned by it to the <code>graticule</code> parameter of <code>plot</code>, to get finer control:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="../reference/st_graticule.html">st_graticule</a></span><span class="op">(</span><span class="va">usa</span>, lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">130</span>,<span class="op">-</span><span class="fl">65</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">usa</span>, graticule <span class="op">=</span> <span class="va">g</span>, key.pos <span class="op">=</span> <span class="cn">NULL</span>, axes <span class="op">=</span> <span class="cn">TRUE</span>,
     xlim <span class="op">=</span> <span class="fu"><a href="../reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">usa</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, ylim <span class="op">=</span> <span class="fu"><a href="../reference/st_bbox.html">st_bbox</a></span><span class="op">(</span><span class="va">usa</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,
     xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>which still doesn’t look great – completely controlling the plotting region of base plots is not easy.</p>
</div>
<div class="section level1">
<h1 id="plotting-sf-objects-with-other-packages">Plotting sf objects with other packages<a class="anchor" aria-label="anchor" href="#plotting-sf-objects-with-other-packages"></a>
</h1>
<div class="section level2">
<h2 id="grid-st_as_grob">grid: <code>st_as_grob</code><a class="anchor" aria-label="anchor" href="#grid-st_as_grob"></a>
</h2>
<p>Package <code>sf</code> provides a number of methods for <code>st_as_grob</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span><span class="va">st_as_grob</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  [1] st_as_grob.CIRCULARSTRING*      st_as_grob.COMPOUNDCURVE*      </span>
<span class="co">##  [3] st_as_grob.CURVEPOLYGON*        st_as_grob.GEOMETRYCOLLECTION* </span>
<span class="co">##  [5] st_as_grob.LINESTRING*          st_as_grob.MULTILINESTRING*    </span>
<span class="co">##  [7] st_as_grob.MULTIPOINT*          st_as_grob.MULTIPOLYGON*       </span>
<span class="co">##  [9] st_as_grob.MULTISURFACE*        st_as_grob.POINT*              </span>
<span class="co">## [11] st_as_grob.POLYGON*             st_as_grob.sfc*                </span>
<span class="co">## [13] st_as_grob.sfc_CIRCULARSTRING*  st_as_grob.sfc_LINESTRING*     </span>
<span class="co">## [15] st_as_grob.sfc_MULTILINESTRING* st_as_grob.sfc_MULTIPOINT*     </span>
<span class="co">## [17] st_as_grob.sfc_MULTIPOLYGON*    st_as_grob.sfc_POINT*          </span>
<span class="co">## [19] st_as_grob.sfc_POLYGON*        </span>
<span class="co">## see '?methods' for accessing help and source code</span></code></pre>
<p>which convert simple simple feature objects into <code>grob</code> (“graphics objects”) objects; <code>grob</code>s are the graphic primitives of the <code>grid</code> plotting package. These methods can be used by plotting packages that build on <code>grid</code>, such as <code>ggplot2</code> (which uses them in <code>geom_sf</code>) and <code>tmap</code>. In addition, <code>st_viewport</code> can be used to set up a grid viewport from an <code>sf</code> object, with an aspect ratio similar to that of <code>base::plot.sf</code>.</p>
</div>
<div class="section level2">
<h2 id="ggplot2">ggplot2<a class="anchor" aria-label="anchor" href="#ggplot2"></a>
</h2>
<p>contains a geom specially for simple feature objects, with support for graticule white lines in the background using <code><a href="../reference/st_graticule.html">sf::st_graticule</a></code>. Support is currently good for polygons; for lines or points, your mileage may vary.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">usa</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>Polygons can be colored using <code>aes</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">nc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">BIR74</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">34</span><span class="op">:</span><span class="fl">36</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>and sets of maps can be plotted as facet plots after rearranging the <code>sf</code> object, e.g. by</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Attaching package: 'dplyr'</span></code></pre>
<pre><code><span class="co">## The following objects are masked from 'package:stats':</span>
<span class="co">## </span>
<span class="co">##     filter, lag</span></code></pre>
<pre><code><span class="co">## The following objects are masked from 'package:base':</span>
<span class="co">## </span>
<span class="co">##     intersect, setdiff, setequal, union</span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="va">nc2</span> <span class="op">&lt;-</span> <span class="va">nc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">SID74</span>, <span class="va">SID79</span>, <span class="va">geom</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">VAR</span>, <span class="va">SID</span>, <span class="op">-</span><span class="va">geom</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">nc2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">SID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">VAR</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">34</span><span class="op">:</span><span class="fl">36</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="mapview">mapview<a class="anchor" aria-label="anchor" href="#mapview"></a>
</h2>
<p>Package <code>mapview</code> creates interactive maps in html pages, using package <code>leaflet</code> as a workhorse. Extensive examples are found <a href="https://r-spatial.github.io/mapview/" class="external-link">here</a>.</p>
<p>An example is obtained by</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/mapview" class="external-link">mapview</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/mapview/man/mapviewOptions.html" class="external-link">mapviewOptions</a></span><span class="op">(</span>fgb <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># needed when creating web pages</span>
<span class="fu"><a href="https://rdrr.io/pkg/mapview/man/mapView.html" class="external-link">mapview</a></span><span class="op">(</span><span class="va">nc</span><span class="op">[</span><span class="st">"BIR74"</span><span class="op">]</span>, col.regions <span class="op">=</span> <span class="fu"><a href="../reference/plot.html">sf.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, fgb <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>gives a map which is interactive: you can zoom and pan, and query features by clicking on them.</p>
</div>
<div class="section level2">
<h2 id="tmap">tmap<a class="anchor" aria-label="anchor" href="#tmap"></a>
</h2>
<p>Package <code>tmap</code> is another package for plotting maps, with emphasis on production-ready maps.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mtennekes/tmap" class="external-link">tmap</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/qtm.html" class="external-link">qtm</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span></code></pre></div>
<p><img src="sf5_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p><code>tmap</code> also has interactive leaflet maps:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_mode.html" class="external-link">tmap_mode</a></span><span class="op">(</span><span class="st">"view"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_fill</a></span><span class="op">(</span><span class="st">"BIR74"</span>, palette <span class="op">=</span> <span class="fu"><a href="../reference/plot.html">sf.colors</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Replotting the last map in non-interactive mode is as simple as:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_mode.html" class="external-link">ttm</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_last.html" class="external-link">tmap_last</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>A draft version of the book <em>Elegant and informative maps with tmap</em> by Martijn Tennekes and Jakub Nowosad is found at <a href="https://r-tmap.github.io/" class="external-link uri">https://r-tmap.github.io/</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Edzer Pebesma.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
