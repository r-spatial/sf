<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>6. Miscellaneous • sf</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="6. Miscellaneous">
<meta property="og:description" content="sf">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9-3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sf1.html">1. Simple Features for R</a>
    </li>
    <li>
      <a href="../articles/sf2.html">2. Reading, Writing and Converting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf3.html">3. Manipulating Simple Feature Geometries</a>
    </li>
    <li>
      <a href="../articles/sf4.html">4. Manipulating Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf5.html">5. Plotting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf6.html">6. Miscellaneous</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-spatial/sf/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>6. Miscellaneous</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/sf/blob/master/vignettes/sf6.Rmd"><code>vignettes/sf6.Rmd</code></a></small>
      <div class="hidden name"><code>sf6.Rmd</code></div>

    </div>

    
    
<p>This vignette describes a number of issues that did not come up in the previous vignettes, and that may or may not be categorized as “frequently asked questions”. Readers are encouraged to provide entries for this vignette (as for the others).</p>
<div id="what-is-this-epsg-code-all-about" class="section level1">
<h1 class="hasAnchor">
<a href="#what-is-this-epsg-code-all-about" class="anchor"></a>What is this EPSG code all about?</h1>
<p>EPSG stands for a maintained, well-understood set of spatial reference systems, maintained by the International Association of Oil &amp; Gass Producers (IOGP). From R, we can get access to the EPSG dataset programmatically (as a <code>data.frame</code>) by:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw pkg">rgdal</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgdal/man/make_EPSG.html">make_EPSG</a></span>()</pre></body></html></div>
<p>see also the first vignette.</p>
</div>
<div id="how-does-sf-deal-with-secondary-geometry-columns" class="section level1">
<h1 class="hasAnchor">
<a href="#how-does-sf-deal-with-secondary-geometry-columns" class="anchor"></a>How does <code>sf</code> deal with secondary geometry columns?</h1>
<p><code>sf</code> objects can have more than one geometry list-column, but always only one geometry column is considered <em>active</em>, and returned by <code>st_geometry</code>. When there are multiple geometry columns, the default <code>print</code> methods reports which one is active:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)
<span class="co">## Linking to GEOS 3.5.0, GDAL 2.2.2, PROJ 4.8.0</span>
<span class="fu"><a href="https://rdrr.io/r/utils/demo.html">demo</a></span>(<span class="no">nc</span>, <span class="kw">ask</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">echo</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">## Reading layer `nc.gpkg' from data source `/tmp/Rtmpdk62PR/temp_libpath657264ed5ac6/sf/gpkg/nc.gpkg' using driver `GPKG'</span>
<span class="co">## Simple feature collection with 100 features and 14 fields</span>
<span class="co">## Attribute-geometry relationship: 0 constant, 8 aggregate, 6 identity</span>
<span class="co">## geometry type:  MULTIPOLYGON</span>
<span class="co">## dimension:      XY</span>
<span class="co">## bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</span>
<span class="co">## CRS:            4267</span>
<span class="no">nc</span>$<span class="no">geom2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/geos_unary.html">st_centroid</a></span>(<span class="fu"><a href="../reference/st_geometry.html">st_geometry</a></span>(<span class="no">nc</span>))
<span class="co">## Warning in st_centroid.sfc(st_geometry(nc)): st_centroid does not give correct</span>
<span class="co">## centroids for longitude/latitude data</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">nc</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="co">## Simple feature collection with 100 features and 14 fields</span>
<span class="co">## Attribute-geometry relationship: 0 constant, 8 aggregate, 6 identity, 1 NA's</span>
<span class="co">## Active geometry column: geom</span>
<span class="co">## geometry type:  MULTIPOLYGON</span>
<span class="co">## dimension:      XY</span>
<span class="co">## bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</span>
<span class="co">## CRS:            4267</span>
<span class="co">## First 2 features:</span>
<span class="co">##    AREA PERIMETER CNTY_ CNTY_ID      NAME  FIPS FIPSNO CRESS_ID BIR74 SID74</span>
<span class="co">## 1 0.114     1.442  1825    1825      Ashe 37009  37009        5  1091     1</span>
<span class="co">## 2 0.061     1.231  1827    1827 Alleghany 37005  37005        3   487     0</span>
<span class="co">##   NWBIR74 BIR79 SID79 NWBIR79                           geom</span>
<span class="co">## 1      10  1364     0      19 MULTIPOLYGON (((-81.47276 3...</span>
<span class="co">## 2      10   542     3      12 MULTIPOLYGON (((-81.23989 3...</span>
<span class="co">##                        geom2</span>
<span class="co">## 1  POINT (-81.49826 36.4314)</span>
<span class="co">## 2 POINT (-81.12515 36.49101)</span></pre></body></html></div>
<p>We can switch the active geometry by using <code>st_geometry&lt;-</code> or <code>st_set_geometry</code>, as in</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/plot.html">plot</a></span>(<span class="fu"><a href="../reference/st_geometry.html">st_geometry</a></span>(<span class="no">nc</span>))</pre></body></html></div>
<p><img src="sf6_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/st_geometry.html">st_geometry</a></span>(<span class="no">nc</span>) <span class="kw">&lt;-</span> <span class="st">"geom2"</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span>(<span class="fu"><a href="../reference/st_geometry.html">st_geometry</a></span>(<span class="no">nc</span>))</pre></body></html></div>
<p><img src="sf6_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
</div>
<div id="does-st_simplify-preserve-topology" class="section level1">
<h1 class="hasAnchor">
<a href="#does-st_simplify-preserve-topology" class="anchor"></a>Does <code>st_simplify</code> preserve topology?</h1>
<p><code>st_simplify</code> is a topology-preserving function, but does this on the level of individual feature geometries. That means, simply said, that after applying it, a polygon will still be a polygon. However when two features have a longer shared boundary, applying <code>st_simplify</code> to the object does not guarantee that in the resulting object these two polygons still have the same boundary in common, since the simplification is done independently, <em>for each feature geometry</em>.</p>
</div>
<div id="why-do-dplyr-verbs-not-work-for-sf-objects" class="section level1">
<h1 class="hasAnchor">
<a href="#why-do-dplyr-verbs-not-work-for-sf-objects" class="anchor"></a>Why do dplyr verbs not work for <code>sf</code> objects?</h1>
<p>They do! However, many developers like to write scripts that never load packages but address all functions by the <code>sf::</code> prefix, as in</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">i</span> <span class="kw">=</span> <span class="kw pkg">sf</span><span class="kw ns">::</span><span class="fu"><a href="../reference/geos_binary_pred.html">st_intersects</a></span>(<span class="no">sf1</span>, <span class="no">sf2</span>)</pre></body></html></div>
<p>This works up to the moment that a <code>dplyr</code> generic like <code>select</code> for an <code>sf</code> object is needed: should one call <code><a href="https://dplyr.tidyverse.org/reference/select.html">dplyr::select</a></code> (won’t know it should search in package <code>sf</code>) or <code>sf::select</code> (which doesn’t exist)? Neither works. One should in this case simply load <code>sf</code>, e.g. by</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)</pre></body></html></div>
</div>
<div id="what-is-this-errorwarningmessage-about" class="section level1">
<h1 class="hasAnchor">
<a href="#what-is-this-errorwarningmessage-about" class="anchor"></a>What is this error/warning/message about?</h1>
<div id="although-coordinates-are-longitudelatitude-xxx-assumes-that-they-are-planar" class="section level2">
<h2 class="hasAnchor">
<a href="#although-coordinates-are-longitudelatitude-xxx-assumes-that-they-are-planar" class="anchor"></a><em>although coordinates are longitude/latitude, xxx assumes that they are planar</em>
</h2>
<p>Most (but not all) of the geometry calculating routines used by <code>sf</code> come from the <a href="https://trac.osgeo.org/geos/">GEOS</a> library. This library considers coordinates in a two-dimensional, flat, Euclidian space. For longitude latitude data, this is not the case. A simple example is a polygon enclosing the North pole, which should include the pole:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">polygon</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sfc.html">st_sfc</a></span>(<span class="fu"><a href="../reference/st.html">st_polygon</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">80</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">120</span>,<span class="fl">80</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">240</span>,<span class="fl">80</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">80</span>)))),
        <span class="kw">crs</span> <span class="kw">=</span> <span class="fl">4326</span>)
<span class="no">pole</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sfc.html">st_sfc</a></span>(<span class="fu"><a href="../reference/st.html">st_point</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">90</span>)), <span class="kw">crs</span> <span class="kw">=</span> <span class="fl">4326</span>)
<span class="fu"><a href="../reference/geos_binary_pred.html">st_intersects</a></span>(<span class="no">polygon</span>, <span class="no">pole</span>)
<span class="co">## although coordinates are longitude/latitude, st_intersects assumes that they are planar</span>
<span class="co">## Sparse geometry binary predicate list of length 1, where the predicate was `intersects'</span>
<span class="co">##  1: (empty)</span></pre></body></html></div>
<p>which gives a wrong result (no intersection).</p>
</div>
<div id="st_centroid-does-not-give-correct-centroids-for-longitudelatitude-data" class="section level2">
<h2 class="hasAnchor">
<a href="#st_centroid-does-not-give-correct-centroids-for-longitudelatitude-data" class="anchor"></a><em>st_centroid does not give correct centroids for longitude/latitude data</em>
</h2>
<p>Similar to the above, centroids are computed assuming flat, 2D space:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="../reference/geos_unary.html">st_centroid</a></span>(<span class="no">polygon</span>)<span class="kw">[[</span><span class="fl">1</span>]]
<span class="co">## Warning in st_centroid.sfc(polygon): st_centroid does not give correct centroids</span>
<span class="co">## for longitude/latitude data</span>
<span class="co">## POINT (120 80)</span></pre></body></html></div>
<p>where the centroid should have been the pole.</p>
</div>
<div id="dist-is-assumed-to-be-in-decimal-degrees-arc_degrees-" class="section level2">
<h2 class="hasAnchor">
<a href="#dist-is-assumed-to-be-in-decimal-degrees-arc_degrees-" class="anchor"></a><em>dist is assumed to be in decimal degrees (arc_degrees).</em>
</h2>
<p>This message indicates that <code>sf</code> assumes a distance value is given in degrees. To avoid this message, pass a value with the right units:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">pt</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sfc.html">st_sfc</a></span>(<span class="fu"><a href="../reference/st.html">st_point</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>)), <span class="kw">crs</span> <span class="kw">=</span> <span class="fl">4326</span>)
<span class="no">buf</span> <span class="kw">=</span> <span class="fu"><a href="../reference/geos_unary.html">st_buffer</a></span>(<span class="no">polygon</span>, <span class="fl">1</span>)
<span class="co">## Warning in st_buffer.sfc(polygon, 1): st_buffer does not correctly buffer</span>
<span class="co">## longitude/latitude data</span>
<span class="co">## dist is assumed to be in decimal degrees (arc_degrees).</span>
<span class="no">buf</span> <span class="kw">=</span> <span class="fu"><a href="../reference/geos_unary.html">st_buffer</a></span>(<span class="no">polygon</span>, <span class="kw pkg">units</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/set_units.html">set_units</a></span>(<span class="fl">1</span>, <span class="no">degree</span>))
<span class="co">## Warning in st_buffer.sfc(polygon, units::set_units(1, degree)): st_buffer does</span>
<span class="co">## not correctly buffer longitude/latitude data</span></pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Edzer Pebesma.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
